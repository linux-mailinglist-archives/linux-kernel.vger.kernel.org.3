Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 3C83F4D882E
	for <lists+linux-kernel@lfdr.de>; Mon, 14 Mar 2022 16:35:13 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S242577AbiCNPft (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Mon, 14 Mar 2022 11:35:49 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:48462 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S242545AbiCNPfd (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Mon, 14 Mar 2022 11:35:33 -0400
Received: from dfw.source.kernel.org (dfw.source.kernel.org [IPv6:2604:1380:4641:c500::1])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 4693521267;
        Mon, 14 Mar 2022 08:34:22 -0700 (PDT)
Received: from smtp.kernel.org (relay.kernel.org [52.25.139.140])
        (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
        (No client certificate requested)
        by dfw.source.kernel.org (Postfix) with ESMTPS id 8861E612B3;
        Mon, 14 Mar 2022 15:34:18 +0000 (UTC)
Received: by smtp.kernel.org (Postfix) with ESMTPSA id E602CC340EE;
        Mon, 14 Mar 2022 15:34:17 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
        s=k20201202; t=1647272058;
        bh=Bnod0IaDodE5BPjyT8EujzYwnAusdu53AQQMt9y+ho0=;
        h=Date:From:To:Cc:Subject:In-Reply-To:References:From;
        b=t73gaSIorFbG9uLRYGMqM/SKSnxBXcquakW7oZSLnr5fn/xbNlsCcEZUc3nUf5wEg
         h86fWkK9Mnr72d+gKXGBvnXJLii41dy44LTzrSUbwNdE3o2Di/+Ey50oC0PK5nmKvp
         BQprk6DEzypkv4Pt5ukLAnIKwDGPd50xPB0Yft5cKc+1BoZGEFv9Fv18e0onClDcSm
         jVP543t8JjYbhewEHMtmHfU0I5Mv+3Ih/lC5tCXtQAqChKb95MY2dI3jskRNa8di9z
         ah7gQD3sLQgiM8QaAZfYd4HbsGiIvglUI5BGm4rE6FlehO6CuYu43MIiUI/PwfGMUJ
         ayOONeHPot1Rw==
Received: from sofa.misterjones.org ([185.219.108.64] helo=why.misterjones.org)
        by disco-boy.misterjones.org with esmtpsa  (TLS1.3) tls TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
        (Exim 4.94.2)
        (envelope-from <maz@kernel.org>)
        id 1nTmi7-00EOSv-HQ; Mon, 14 Mar 2022 15:34:15 +0000
Date:   Mon, 14 Mar 2022 15:34:15 +0000
Message-ID: <87k0cwzgy0.wl-maz@kernel.org>
From:   Marc Zyngier <maz@kernel.org>
To:     Rob Herring <robh+dt@kernel.org>
Cc:     Vladimir Oltean <vladimir.oltean@nxp.com>,
        devicetree@vger.kernel.org,
        "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
        linux-arm-kernel <linux-arm-kernel@lists.infradead.org>,
        Shawn Guo <shawnguo@kernel.org>, Li Yang <leoyang.li@nxp.com>,
        Biwen Li <biwen.li@nxp.com>,
        Zhiqiang Hou <Zhiqiang.Hou@nxp.com>,
        Kurt Kanzenbach <kurt@linutronix.de>,
        Rasmus Villemoes <linux@rasmusvillemoes.dk>,
        Arnd Bergmann <arnd@arndb.de>
Subject: Re: [PATCH v2 devicetree] Revert "arm64: dts: freescale: Fix 'interrupt-map' parent address cells"
In-Reply-To: <CAL_JsqLuD97y=rqRRUw5owvoetLh926ebkmMdGut+gyqTS5hWQ@mail.gmail.com>
References: <20211214135852.2934670-1-vladimir.oltean@nxp.com>
        <CAL_JsqLuD97y=rqRRUw5owvoetLh926ebkmMdGut+gyqTS5hWQ@mail.gmail.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL-LB/10.8 EasyPG/1.0.0 Emacs/27.1
 (x86_64-pc-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-SA-Exim-Connect-IP: 185.219.108.64
X-SA-Exim-Rcpt-To: robh+dt@kernel.org, vladimir.oltean@nxp.com, devicetree@vger.kernel.org, linux-kernel@vger.kernel.org, linux-arm-kernel@lists.infradead.org, shawnguo@kernel.org, leoyang.li@nxp.com, biwen.li@nxp.com, Zhiqiang.Hou@nxp.com, kurt@linutronix.de, linux@rasmusvillemoes.dk, arnd@arndb.de
X-SA-Exim-Mail-From: maz@kernel.org
X-SA-Exim-Scanned: No (on disco-boy.misterjones.org); SAEximRunCond expanded to false
X-Spam-Status: No, score=-8.6 required=5.0 tests=BAYES_00,DKIMWL_WL_HIGH,
        DKIM_SIGNED,DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,RCVD_IN_DNSWL_HI,
        SPF_HELO_NONE,SPF_PASS,T_SCC_BODY_TEXT_LINE autolearn=ham
        autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

On Mon, 14 Mar 2022 15:15:15 +0000,
Rob Herring <robh+dt@kernel.org> wrote:
> 
> On Tue, Dec 14, 2021 at 6:59 AM Vladimir Oltean <vladimir.oltean@nxp.com> wrote:
> > Therefore, the premise of the patch being reverted here is invalid.
> > It doesn't matter whether the driver, in its non-standard use of the
> > property, complies to the standard format or not, since this property
> > isn't expected to be used for interrupt translation by the core.
> 
> I disagree. The non-standard part is that 'interrupt-map' translation
> is not transparent. 'interrupt-map' that can't be parsed in the
> standard way is just wrong, and I imagine was never the intention
> here. We simply cannot have platforms defining their own format for
> standard properties.

That ship sailed a long while ago. We have a list of offenders, and we
can make sure we don't get additional ones.

> Reverting this will cause dtc warnings now (IIRC) and just kicks the
> can down the road. Reverting is fine for now (I gave Arnd the okay on
> IRC), but I think the parsing will need to be updated to honor
> #address-cells and detect an old DT (probably by looking at the total
> size of 'interrupt-map') and mark that change for stable. That would
> only leave a new dt with an old kernel without stable updates broken.
> Seems unlikely a device is getting firmware updates, but not OS
> updates.

Being able to rollback firmware and OS independently is important. The
tooling can be taught about the broken instances, which should be
enough.  Adding to the parsing only makes things harder to maintain,
for no real gain.

	M.

-- 
Without deviation from the norm, progress is not possible.
